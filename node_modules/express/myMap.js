
  var fBase = new Firebase("https://glowing-inferno-6337.firebaseio.com/");
  var node = fBase.child("Tweets");
  var flag = false;
  var information = {};
  var map;
  function initMap() {
  var map = new google.maps.Map(document.getElementById('map'), {
  zoom: 4,
  center: {lat: 37.090, lng: -95.712},
  mapTypeId: google.maps.MapTypeId.TERRAIN
  });
  var name = node.key();
  var snapshot;
    var keyVal;
  node.on("child_added",function(snapshot,prevChildKey){
      var newInfo = snapshot.val();
      var keyVal = snapshot.key();
      console.log(keyVal);
      var latitude = newInfo.long;
      var lon= newInfo.lat;
      var feeling = newInfo.attitude;
      var who = newInfo.who;
      var color = '#ff0000';
      if(feeling==="Negative"){
      color='#ff0000';
      }
      else if(feeling ==="Positive"){
      color = "#1aff1a";
      }
      else{
      color = "#ffb366";
      }
      var newCircle = new google.maps.Circle({
      fillColor: color,
      strokeColor:color,
      strokeOpacity: .9,
      strokeWeight: 1,
	  clickable: true,
      fillOpacity: 0.4,
      title: "myTitle",
      map: map,
      center: {lat:latitude,lng:lon},
      radius:10000
      });
	  var contentWindow = '<div id="content" style="color:black">'+
      '<div id="siteNotice">'+
      '</div>'+
      '<h3 id="firstHeading" class="firstHeading">'+ who.charAt(0).toUpperCase() + who.slice(1) + '</h3>'+
      '<div id="bodyContent">'+
      '<p><b>'+ "tweet"+ '</b>'
      '</div>'+
      '</div>';
var infoWindow= new google.maps.InfoWindow({
    content: contentWindow
    });
google.maps.event.addListener(newCircle, 'click', function(ev){
    infoWindow.setPosition(ev.latLng);
    infoWindow.open(map);
});


  });

  node.on("child_changed",function(snapshot,prevChildKey){
      var newInfo = snapshot.val();
       keyVal = snapshot.key();
      console.log(keyVal);
      var latitude = newInfo.long;
      var lon= newInfo.lat;
      var feeling = newInfo.attitude;
      var who = newInfo.who;
      var color = '#ff0000';
      if(feeling==="Negative"){
      color='#ff0000';
      }
      else if(feeling ==="Positive"){
      color = "#1aff1a";
      }
      else{
      color = "#ffb366";
      }
      var newCircle = new google.maps.Circle({
      fillColor: color,
      strokeColor:color,
      strokeOpacity: .9,
      strokeWeight: 1,
      fillOpacity: 0.4,
	  clickable: false,
      title: "myTitle",
      map: map,
      center: {lat:latitude,lng:lon},
      radius:1000
      });

 var infoWindow= new google.maps.InfoWindow({
    content: "Your info here"
    });
  google.maps.event.addListener(newCircle, 'click', function(ev){
    infoWindow.setPosition(newCircle.getCenter());
    infoWindow.open(map);
});


  });
 
  var lastOne = node.child(keyVal);
  lastOne.update({updated:"true"});

  }
